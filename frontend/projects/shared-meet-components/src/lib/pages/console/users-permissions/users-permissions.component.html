<div class="ov-page-container ov-mb-xxl">
	<div class="page-header">
		<div class="title">
			<mat-icon class="material-symbols-outlined ov-settings-icon">passkey</mat-icon>
			<h1>Users & permissions</h1>
		</div>
		<p class="subtitle">
			Configure authentication settings and access controls to manage who can join your rooms and their
			permissions.
		</p>
	</div>

	@if (isLoading()) {
		<div class="ov-page-loading">
			<div class="loading-content">
				<div class="loading-header">
					<div class="loading-title">
						<mat-icon class="ov-settings-icon loading-icon"> settings </mat-icon>
						<h1>Loading Settings</h1>
					</div>
					<p class="loading-subtitle">Please wait while we fetch your settings...</p>
				</div>

				<div class="loading-spinner-container">
					<mat-spinner diameter="48"></mat-spinner>
				</div>
			</div>
		</div>
	} @else {
		<div class="page-content">
			<!-- Branding Section -->
			<!-- <mat-card class="section-card branding-section">
				<mat-card-header>
					<div mat-card-avatar>
						<mat-icon class="section-icon">palette</mat-icon>
					</div>
					<mat-card-title>Branding</mat-card-title>
				</mat-card-header>

				<mat-divider class="section-divider"></mat-divider>

				<mat-card-content>
					<ov-logo-selector></ov-logo-selector>
				</mat-card-content>
			</mat-card> -->

			<!-- Users Section -->
			<mat-card class="section-card branding-section">
				<mat-card-header class="users-header">
					<div mat-card-avatar class="users-avatar">
						<mat-icon class="section-icon users-icon">group</mat-icon>
					</div>
					<mat-card-title class="users-title">Users</mat-card-title>
				</mat-card-header>

				<mat-divider class="section-divider"></mat-divider>

				<mat-card-content>
					<div class="form-section">
						<div class="form-field-header">
							<h3>User Authentication</h3>
						</div>
						<p class="field-description">Choose how users will authenticate to join rooms.</p>
						<mat-form-field
							subscriptSizing="dynamic"
							appearance="outline"
							class="user-management-select-field"
						>
							<mat-select [value]="'single'">
								<mat-option value="single">Single user</mat-option>
								<mat-option value="multiusers" [disabled]="true">
									Multi-user authentication (OAuth & credentials)
									<ov-pro-feature-badge class="users-pro-badge"></ov-pro-feature-badge>
								</mat-option>
								<mat-option value="oauth" [disabled]="true">Only OAuth </mat-option>
							</mat-select>
						</mat-form-field>
					</div>

					<!-- Change Admin Password -->
					<div class="form-section">
						<div class="form-field-header">
							<h3>Admin Authentication</h3>
							<p class="field-description">
								Change the password for the admin user for OpenVidu Meet access.
							</p>
						</div>

						<div class="admin-auth-form">
							<mat-form-field subscriptSizing="dynamic" appearance="outline" class="username-field">
								<mat-label>Username</mat-label>
								<input matInput type="text" value="Admin (TODO)" disabled />
							</mat-form-field>

							<mat-form-field subscriptSizing="dynamic" appearance="outline" class="password-field">
								<mat-label>Password</mat-label>
								<input
									matInput
									type="password"
									formControlName="adminPassword"
									placeholder="••••••••"
								/>
								<mat-hint>Minimum of 8 characters</mat-hint>
								@if (getFieldError(authForm, 'adminPassword')) {
									<mat-error>{{ getFieldError(authForm, 'adminPassword') }}</mat-error>
								}
							</mat-form-field>
						</div>
					</div>
				</mat-card-content>
				<mat-card-actions>
					<button mat-raised-button color="primary" type="submit" (click)="onSaveAccess()">
						Save Admin password
					</button>
				</mat-card-actions>
			</mat-card>

			<!-- Access & Permissions Section -->
			<mat-card class="section-card access-section">
				<mat-card-header>
					<div mat-card-avatar>
						<mat-icon class="section-icon">security</mat-icon>
					</div>
					<mat-card-title>Access & Permissions</mat-card-title>
				</mat-card-header>

				<mat-divider class="section-divider"></mat-divider>

				<mat-card-content>
					<form [formGroup]="authForm" (ngSubmit)="onSaveAccess()">
						<!-- Authentication for joining room -->
						<div class="form-section">
							<div class="form-field-header">
								<h3>Authentication for joining room</h3>
							</div>
							<p class="field-description">Choose which users must authenticate for joining room.</p>

							<mat-form-field subscriptSizing="dynamic" appearance="outline" class="auth-select-field">
								<mat-label>Select...</mat-label>
								<mat-select formControlName="authModeToAccessRoom">
									@for (option of authModeOptions; track option.value) {
										<mat-option [value]="option.value">{{ option.label }}</mat-option>
									}
								</mat-select>
								@if (getFieldError(authForm, 'authModeToAccessRoom')) {
									<mat-error>{{ getFieldError(authForm, 'authModeToAccessRoom') }}</mat-error>
								}
							</mat-form-field>
						</div>
					</form>
				</mat-card-content>
				<mat-card-actions>
					<button mat-raised-button color="primary" type="submit" (click)="onSaveAccess()">
						Save Configuration
					</button>
				</mat-card-actions>
			</mat-card>
		</div>
	}
</div>
