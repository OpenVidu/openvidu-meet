@if (!showRoom) {
	<div class="form-container">
		<div class="card-wrapper">
			<mat-card class="form-card">
				<h2 class="form-title">
					Access room <strong>{{ roomId }}</strong>
				</h2>
				<form [formGroup]="participantForm" (ngSubmit)="submitAccessRoom()">
					<mat-form-field appearance="outline" class="full-width">
						<mat-label>Name</mat-label>
						<input
							id="participant-name-input"
							matInput
							placeholder="Enter your name"
							formControlName="name"
							required
						/>
						@if (participantForm.get('name')?.hasError('minlength')) {
							<mat-error> The name must be at least <strong>4 characters</strong> </mat-error>
						}
						@if (participantForm.get('name')?.hasError('required')) {
							<mat-error> The name is <strong>required</strong> </mat-error>
						}
						@if (participantForm.get('name')?.hasError('participantExists')) {
							<mat-error>
								The name is already taken. <strong> Please choose another name </strong>
							</mat-error>
						}
					</mat-form-field>

					<button
						mat-raised-button
						color="primary"
						id="participant-name-submit"
						class="full-width"
						[disabled]="participantForm.invalid"
					>
						Continue to room
					</button>
				</form>
			</mat-card>

			<mat-card class="recordings-card">
				<div class="recordings-content">
					<h3>View recordings</h3>
					<button id="view-recordings-btn" mat-stroked-button color="accent" (click)="goToRecordings()">
						Go to recordings
					</button>
				</div>
			</mat-card>
		</div>
	</div>
} @else {
	<ov-videoconference
		[token]="participantToken"
		[participantName]="participantName"
		[prejoin]="true"
		[prejoinDisplayParticipantName]="false"
		[videoEnabled]="features().videoEnabled"
		[audioEnabled]="features().audioEnabled"
		[toolbarLeaveButton]="!features().canModerateRoom"
		[toolbarCameraButton]="features().showCamera"
		[toolbarMicrophoneButton]="features().showMicrophone"
		[toolbarScreenshareButton]="features().showScreenShare"
		[toolbarFullscreenButton]="features().showFullscreen"
		[toolbarChatPanelButton]="features().showChat"
		[toolbarParticipantsPanelButton]="features().showParticipantList"
		[toolbarRecordingButton]="features().showRecording"
		[toolbarBroadcastingButton]="false"
		[toolbarBackgroundEffectsButton]="features().showBackgrounds"
		[toolbarActivitiesPanelButton]="features().showRecording"
		[toolbarSettingsButton]="features().showSettings"
		[activitiesPanelRecordingActivity]="features().showRecording"
		[activitiesPanelBroadcastingActivity]="false"
		(onTokenRequested)="onTokenRequested()"
		(onParticipantConnected)="onParticipantConnected($event)"
		(onParticipantLeft)="onParticipantLeft($event)"
		(onRecordingStartRequested)="onRecordingStartRequested($event)"
		(onRecordingStopRequested)="onRecordingStopRequested($event)"
	>
		@if (features().canModerateRoom) {
			<div *ovToolbarAdditionalButtons id="leave-btn" class="custom-leave-btn" style="text-align: center">
				<button
					mat-icon-button
					[matMenuTriggerFor]="leaveMenu"
					matTooltip="Leave options"
					[disableRipple]="true"
				>
					<mat-icon>call_end</mat-icon>
				</button>
				<mat-menu #leaveMenu="matMenu">
					<button mat-menu-item (click)="leaveMeeting()">
						<mat-icon>logout</mat-icon>

						<span>Leave meeting</span>
					</button>
					<mat-divider></mat-divider>
					<button mat-menu-item (click)="endMeeting()">
						<mat-icon>no_meeting_room</mat-icon>
						<span>End meeting for all</span>
					</button>
				</mat-menu>
			</div>
		}
	</ov-videoconference>
}
